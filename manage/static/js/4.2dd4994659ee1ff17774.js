webpackJsonp([4],{FNhj:function(e,t,a){e.exports=a.p+"static/img/xilie_cover.f167438.png"},Z1YU:function(e,t){},tQqs:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("KH7x"),r=a.n(n),s=a("lC5x"),o=a.n(s),i=a("J0Oq"),l=a.n(i),c=a("h0S9"),u=a("FNhj"),p={name:"CourseIndex",data:function(){return{formLabelWidth:"120px",tableData:[],searchName:"",pageSize:5,currentPage:1,cates:[],visible:!1,total:0,course_cover:u,cate_selected:"",showMoney:!1,showMoneyByTime:!1,dialogVisible:!1,multipleSelection:[],aloneCurrentPage:1,alonePageSize:5,allCoursesTotal:0,allCourses:[],form:{course_name:"",pay_type:"0",pay_money_type:[{price:"",time:""}]},payTypes:[{id:1,name:"固定收费"},{id:2,name:"按天收费"},{id:3,name:"按月收费"},{id:4,name:"按年收费"}],batchPid:""}},mounted:function(){var e=this;return l()(o.a.mark(function t(){var a;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.getCates();case 2:a=t.sent,e.cates=a.data,e.fetData();case 5:case"end":return t.stop()}},t,e)}))()},methods:{fetData:function(){var e=this;return l()(o.a.mark(function t(){var a,n,r,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.many_list({page:e.currentPage,pageSize:e.pageSize,course_cate:e.cate_selected,course_name:e.searchName});case 2:a=t.sent,n=a.data,r=n.list,s=n.total,r=e.setListItemCateName(r),e.tableData=r,e.total=s;case 7:case"end":return t.stop()}},t,e)}))()},setListItemCateName:function(e){var t=this;return e.forEach(function(e){t.cates.forEach(function(t){e.course_cate==t.id&&(e.course_cate_name=t.name)})}),e},cateChange:function(){this.currentPage=1,this.fetData()},nameChange:function(){this.fetData()},handleSizeChange:function(e){this.pageSize=e,this.fetData()},handleCurrentChange:function(e){this.currentPage=e,this.fetData()},toAddCourse:function(){this.visible=!0},createCourse:function(){var e=this;return l()(o.a.mark(function t(){var a,n,r,s,i,l,u,p,_;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.form,n=a.pay_type,r=a.course_name,s=a.pay_money_type,(i={course_name:r,pay_type:parseInt(n),pay_money_type:[]}).course_name){t.next=7;break}return e.$message.error("请填写课程名称"),t.abrupt("return");case 7:if(i.pay_type){t.next=12;break}return e.$message.error("请选择收费类型"),t.abrupt("return");case 12:if(1!=n){t.next=21;break}if(l=!1,s.forEach(function(e){e.price||(l=!0)}),!l){t.next=18;break}return e.$message.error("请填写收费金额"),t.abrupt("return");case 18:i.pay_money_type=s,t.next=27;break;case 21:if(u=!1,s.forEach(function(e){(e.time<=0||!e.price)&&(u=!0)}),!u){t.next=26;break}return e.$message.error("请正确填写金额相关输入框"),t.abrupt("return");case 26:i.pay_money_type=s;case 27:return t.next=29,c.many_add(i);case 29:p=t.sent,e.visible=!1,_=p.data.insertId,e.$alert("新建系列课成功",{confirmButtonText:"去优化",callback:function(t){e.$router.push({path:"/course/many_detail/"+_})}});case 33:case"end":return t.stop()}},t,e)}))()},intoPlay:function(e){var t=e.id;this.$router.push({path:"/course/many_detail/"+t})},intoEdit:function(e){var t=e.id;this.$router.push({path:"/course/many_detail/"+t})},changePayType:function(e){e=parseInt(e);this.showMoney=!1,this.showMoneyByTime=!1,1==e?this.showMoney=!0:(this.showMoneyByTime=!0,this.form.pay_money_type=[{time:"",pay_money:""}])},handleCommand:function(e){var t=e.split("|"),a=r()(t,2),n=a[0],s=a[1];switch(n){case"a":this.$router.push({path:"/course/add",query:{pid:s}});break;case"b":this.addHasCourse(s)}},jumpPage:function(e){var t=e.id;this.$router.push({path:"/course/many_panel",query:{id:t}})},addTypeByTime:function(){this.form.pay_money_type.push({time:"",pay_money:""})},delPayMonnyItem:function(e){this.form.pay_money_type.splice(e,1),console.log(this.form.pay_money_type)},addHasCourse:function(e){this.dialogVisible=!0,this.batchPid=e,this.getAllAloneCourses()},getAllAloneCourses:function(){var e=this;return l()(o.a.mark(function t(){var a,n,r,s;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,c.list({page:e.aloneCurrentPage,pageSize:e.alonePageSize,status:""});case 2:a=t.sent,n=a.data,r=n.list,s=n.total,e.allCourses=r,e.allCoursesTotal=s;case 6:case"end":return t.stop()}},t,e)}))()},handleAloneCurrentChange:function(e){this.aloneCurrentPage=e,this.getAllAloneCourses()},handleSelectionChange:function(e){this.multipleSelection=e},okAdd:function(){var e=this;return l()(o.a.mark(function t(){var a,n,r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.multipleSelection,n=[],a.forEach(function(e){n.push(e.id)}),n.length){t.next=6;break}return e.$message.error("请选择要添加的课程"),t.abrupt("return");case 6:return t.next=8,c.batchPids({ids:n,pid:e.batchPid});case 8:r=t.sent,e.dialogVisible=!1,r&&(e.$message.success("添加完成"),e.batchPid="");case 11:case"end":return t.stop()}},t,e)}))()}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"hello"},[a("div",{staticClass:"top_info"},[a("el-button-group",{staticClass:"btn_wrap"},[a("el-button",{attrs:{type:"primary"},on:{click:e.toAddCourse}},[e._v("新建系列课")])],1),e._v(" "),a("div",{staticClass:"right_search"},[a("label",{staticClass:"label"},[e._v("选择收费类型：")]),e._v(" "),a("el-select",{attrs:{placeholder:"请选择",clearable:""},on:{change:e.cateChange},model:{value:e.cate_selected,callback:function(t){e.cate_selected=t},expression:"cate_selected"}},e._l(e.cates,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1),e._v(" "),a("el-input",{staticClass:"input_search",attrs:{placeholder:"请输入系列课名称",clearable:""},on:{clear:e.nameChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nameChange(t)}},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:e.nameChange},slot:"suffix"})])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.tableData,"header-cell-style":{"background-color":"#f9fbff",height:"80px",color:"rgba(43,57,64,.85)","border-bottom":"1px #f0f0f0 solid","border-top":"1px #f0f0f0 solid"}}},[a("el-table-column",{attrs:{prop:"course_cover",width:"150",label:"封面"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.course_cover?a("img",{staticClass:"cover",attrs:{src:t.row.course_cover}}):a("img",{staticClass:"cover",attrs:{src:e.course_cover}})]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"course_name",label:"课程名称",fit:""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"course_name"},[e._v(e._s(t.row.course_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"付费类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.pay_type?a("span",[e._v("固定收费")]):e._e(),e._v(" "),2==t.row.pay_type?a("span",[e._v("按天收费")]):e._e(),e._v(" "),3==t.row.pay_type?a("span",[e._v("按月收费")]):e._e(),e._v(" "),4==t.row.pay_type?a("span",[e._v("按年收费")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"价格",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"money"},[1==t.row.pay_type?a("div",{staticClass:"by_time"},[a("strong",[e._v("￥"+e._s(t.row.price))])]):2==t.row.pay_type?a("div",{staticClass:"by_time"},[a("strong",[e._v(e._s(t.row.time))]),e._v("天收取"),a("strong",[e._v(e._s(t.row.price))]),e._v("元\n                    ")]):3==t.row.pay_type?a("div",{staticClass:"by_time"},[a("strong",[e._v(e._s(t.row.time))]),e._v("月收取"),a("strong",[e._v(e._s(t.row.price))]),e._v("元\n                    ")]):4==t.row.pay_type?a("div",{staticClass:"by_time"},[a("strong",[e._v(e._s(t.row.time))]),e._v("年收取"),a("strong",[e._v(e._s(t.row.price))]),e._v("元\n                    ")]):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"course_cate_name",label:"课程分类",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_time",width:"240",label:"更新时间"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"340",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-link",{staticClass:"editbtn",attrs:{type:"primary"},on:{click:function(a){return e.intoEdit(t.row)}}},[e._v("编辑课程")]),e._v(" "),a("el-link",{attrs:{type:"success"},on:{click:function(a){return e.jumpPage(t.row)}}},[e._v("管理单课")]),e._v(" "),a("el-dropdown",{staticStyle:{"margin-left":"10px"},attrs:{"split-button":!0,type:"info"},on:{command:e.handleCommand},scopedSlots:e._u([{key:"dropdown",fn:function(){return[a("el-dropdown-menu",[a("el-dropdown-item",{attrs:{command:"a|"+t.row.id}},[e._v("新建单课")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"b|"+t.row.id}},[e._v("选择已有单课")]),e._v(" "),a("el-dropdown-item",{attrs:{command:"c|"+t.row.id}},[e._v("进入直播")])],1)]},proxy:!0}],null,!0)},[a("span",{staticClass:"el-dropdown-link"},[e._v("更多操作")])])]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"30px 0"}},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.currentPage,"page-sizes":[5,10,20,30,40,50],"page-size":e.pageSize,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-dialog",{attrs:{title:"新建系列课",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{required:"",label:"课程名称","label-width":e.formLabelWidth}},[a("el-input",{model:{value:e.form.course_name,callback:function(t){e.$set(e.form,"course_name",t)},expression:"form.course_name"}})],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"收费类型","label-width":e.formLabelWidth}},[a("el-radio-group",{on:{change:e.changePayType},model:{value:e.form.pay_type,callback:function(t){e.$set(e.form,"pay_type",t)},expression:"form.pay_type"}},e._l(e.payTypes,function(t){return a("el-radio",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])}),1)],1),e._v(" "),e.showMoney?a("el-form-item",{attrs:{required:"",label:"金额","label-width":e.formLabelWidth}},e._l(e.form.pay_money_type,function(t,n){return a("div",{key:n},[a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),a("span",[e._v(" 元")])],1)}),0):e._e(),e._v(" "),e.showMoneyByTime?a("el-form-item",{attrs:{required:"",label:"金额","label-width":e.formLabelWidth}},[2==e.form.pay_type?a("div",e._l(e.form.pay_money_type,function(t,n){return a("div",{key:n,staticClass:"pay_money_type_item"},[a("el-input-number",{staticClass:"short_input",model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}}),e._v(" "),a("span",[e._v(" 天收取")]),e._v(" "),a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")]),e._v(" "),0!=n?a("el-link",{staticClass:"del_btn",attrs:{type:"danger"},on:{click:function(t){return e.delPayMonnyItem(n)}}},[e._v("删除")]):e._e()],1)}),0):3==e.form.pay_type?a("div",e._l(e.form.pay_money_type,function(t,n){return a("div",{key:n,staticClass:"pay_money_type_item"},[a("el-input-number",{staticClass:"short_input",model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}}),e._v(" "),a("span",[e._v(" 月收取")]),e._v(" "),a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")]),e._v(" "),0!=n?a("el-link",{staticClass:"del_btn",attrs:{type:"danger"},on:{click:function(t){return e.delPayMonnyItem(n)}}},[e._v("删除")]):e._e()],1)}),0):4==e.form.pay_type?a("div",e._l(e.form.pay_money_type,function(t,n){return a("div",{key:n,staticClass:"pay_money_type_item"},[a("el-input-number",{staticClass:"short_input",model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}}),e._v(" "),a("span",[e._v(" 年收取")]),e._v(" "),a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")]),e._v(" "),0!=n?a("el-link",{staticClass:"del_btn",attrs:{type:"danger"},on:{click:function(t){return e.delPayMonnyItem(n)}}},[e._v("删除")]):e._e()],1)}),0):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addTypeByTime}},[e._v("添加一个类型")])],1):e._e()],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.createCourse}},[e._v("完 成")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加已有单课",width:"50%",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-table",{attrs:{data:e.allCourses,"header-cell-style":{"background-color":"#f9fbff",height:"50px",color:"rgba(43,57,64,.85)","border-bottom":"1px #f0f0f0 solid","border-top":"1px #f0f0f0 solid"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{type:"course_cover",label:"课程封面",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.course_cover?a("img",{staticClass:"cover",attrs:{width:"100",src:t.row.course_cover}}):a("img",{staticClass:"cover",attrs:{width:"100",src:e.course_cover}})]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"course_name",label:"课程名称",fit:"",height:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.course_name.length>20?t.row.course_name.slice(0,20)+"...":t.row.course_name.slice(0,20)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{property:"create_time",width:"180",label:"创建时间"}})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"20px 0 0"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.aloneCurrentPage,total:e.allCoursesTotal,"page-size":e.alonePageSize},on:{"current-change":e.handleAloneCurrentChange}})],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.okAdd}},[e._v("确定添加")])],1)],1)},staticRenderFns:[]};var d=a("C7Lr")(p,_,!1,function(e){a("Z1YU")},"data-v-21225a22",null);t.default=d.exports}});