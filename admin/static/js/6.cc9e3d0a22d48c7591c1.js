webpackJsonp([6],{FNhj:function(e,t,r){e.exports=r.p+"static/img/xilie_cover.f167438.png"},G7f9:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("lC5x"),o=r.n(a),n=r("J0Oq"),s=r.n(n),i=r("pIEA"),c=r.n(i),u=r("QmSG"),l=r("q7OS"),p=r("h0S9"),m=r("FNhj"),f={name:"CourseAloneDetail",components:{VueUeditorWrap:c.a},data:function(){return{activeName:"first",formLabelWidth:"130",course_cover:m,cate_selected:"",cates:[],ueConfig:{autoHeightEnabled:!1,initialFrameHeight:640,initialFrameWidth:"100%",autoFloatEnabled:!1,serverUrl:u.b+"/upload/ue_upload",UEDITOR_HOME_URL:"/static/UEditor/"},form:{course_name:"",course_num:"",course_cate:"",course_cover:"",pay_type:"",course_content:"",pay_money_type:[]},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},payTypes:[{id:1,name:"固定收费"}]}},mounted:function(){this.fetData()},methods:{fetData:function(){var e=this;return s()(o.a.mark(function t(){var r,a,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.$route.params.id,t.next=3,p.get_manycourse({id:r});case 3:return a=t.sent,t.next=6,p.getCates();case 6:n=t.sent,e.cates=n.data,0==a.data.course_cate&&(a.data.course_cate=""),e.form=a.data,console.log(a.data);case 11:case"end":return t.stop()}},t,e)}))()},saveData:function(){var e=this;return s()(o.a.mark(function t(){var r,a,n,s,i,c,u,m,f,d,_;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.$route.params.id,a=e.form,n=a.course_name,s=a.course_num,i=a.course_cate,c=a.course_cover,u=a.course_content,m=a.pay_type,f=a.pay_money_type,n){t.next=5;break}return l.Message.error("课程主题不能为空"),t.abrupt("return");case 5:if(s){t.next=8;break}return l.Message.error("请设置排课计划"),t.abrupt("return");case 8:if(i){t.next=11;break}return l.Message.error("请选择课程分类"),t.abrupt("return");case 11:if(c){t.next=14;break}return l.Message.error("请上传课程封面"),t.abrupt("return");case 14:if(u){t.next=17;break}return l.Message.error("请填写课程内容"),t.abrupt("return");case 17:if(1!=m){t.next=23;break}if(d=!1,f.forEach(function(e){e.price||(d=!0)}),!d){t.next=23;break}return l.Message.error("请正确填写金额相关输入框"),t.abrupt("return");case 23:if(1==m){t.next=29;break}if(_=!1,f.forEach(function(e){(e.time<=0||!e.price)&&(_=!0)}),!_){t.next=29;break}return l.Message.error("请正确填写金额相关输入框"),t.abrupt("return");case 29:return t.next=31,p.many_done({id:r,course_name:n,course_num:s,course_cate:i,course_cover:c,course_content:u,pay_type:m,pay_money_type:f});case 31:200==t.sent.code?(e.$store.dispatch("tagsView/delView",e.$route),e.$router.replace({path:"/course/many_index"})):l.Message.error("数据保存失败");case 33:case"end":return t.stop()}},t,e)}))()},cateChange:function(e){console.log(e)},uploadSectionFile:function(e){var t=this;return s()(o.a.mark(function r(){var a,n,s;return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.file,(n=new FormData).append("file",a),r.next=5,p.uploadAloneCover(n);case 5:s=r.sent,t.form.course_cover=s.data.data.imagePath;case 7:case"end":return r.stop()}},r,t)}))()},addTypeByTime:function(){this.form.pay_money_type.push({time:"",price:""})},delPayMonnyItem:function(e){this.form.pay_money_type.splice(e,1),console.log(this.form.pay_money_type)}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap"},[r("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[r("el-tab-pane",{attrs:{label:"课程编辑",name:"first"}},[r("el-form",{staticStyle:{"max-width":"1200px","padding-left":"30px"},attrs:{model:e.form,"label-position":"top"}},[r("el-form-item",{attrs:{required:"",label:"系列课名称","label-width":e.formLabelWidth}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.course_name,callback:function(t){e.$set(e.form,"course_name",t)},expression:"form.course_name"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"排课计划","label-width":e.formLabelWidth}},[r("el-input-number",{attrs:{min:1,max:100,label:"排课计划"},model:{value:e.form.course_num,callback:function(t){e.$set(e.form,"course_num",t)},expression:"form.course_num"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"系列课分类","label-width":e.formLabelWidth}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.cateChange},model:{value:e.form.course_cate,callback:function(t){e.$set(e.form,"course_cate",t)},expression:"form.course_cate"}},e._l(e.cates,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"课程封面","label-width":e.formLabelWidth}},[r("div",{staticClass:"cover"},[e.form.course_cover?r("img",{attrs:{src:e.form.course_cover}}):r("div",{staticClass:"empty_pic"},[e._v("建议尺寸800×500，gif、jpg、jpeg、png格式，图片小于5M。")])]),e._v(" "),r("el-upload",{staticClass:"upload_box",attrs:{action:"fakeaction","show-file-list":!1,"auto-upload":!0,"http-request":e.uploadSectionFile}},[r("el-button",{attrs:{type:"danger"}},[e._v("点击上传")]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("建议尺寸800×500，gif、jpg、jpeg、png格式，图片小于5M。")])],1)],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"收费类型","label-width":e.formLabelWidth}},[r("el-radio-group",{model:{value:e.form.pay_type,callback:function(t){e.$set(e.form,"pay_type",t)},expression:"form.pay_type"}},e._l(e.payTypes,function(t){return r("el-radio",{key:t.id,attrs:{disabled:t.id!=e.form.pay_type,label:t.id}},[e._v(e._s(t.name))])}),1),e._v(" "),1==e.form.pay_type?r("div",{staticClass:"pay_money_box"},e._l(e.form.pay_money_type,function(t,a){return r("div",{key:a},[r("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(r){e.$set(t,"price",r)},expression:"item.price"}}),e._v(" "),r("span",[e._v(" 元")])],1)}),0):e._e()],1),e._v(" "),r("el-form-item",{staticClass:"UEditor",attrs:{required:"",label:"课程内容","label-width":e.formLabelWidth}},[r("VueUeditorWrap",{attrs:{config:e.ueConfig},model:{value:e.form.course_content,callback:function(t){e.$set(e.form,"course_content",t)},expression:"form.course_content"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保 存 数 据")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var _=r("C7Lr")(f,d,!1,function(e){r("u2O9")},"data-v-246bc620",null);t.default=_.exports},u2O9:function(e,t){}});