webpackJsonp([18],{ZnMK:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.list=function(e){return Object(a.a)({url:"/admin/flash_sale/list",method:"get",params:e})},t.add=function(e){return Object(a.a)({url:"/admin/flash_sale/add",method:"post",data:e})},t.edit=function(e){return Object(a.a)({url:"/admin/flash_sale/edit",method:"put",data:e})},t.query=function(e){return Object(a.a)({url:"/admin/flash_sale/query",method:"get",params:e})},t.deleteItem=function(e){return Object(a.a)({url:"/admin/flash_sale/delete",method:"delete",params:e})},t.updateStatus=function(e){return Object(a.a)({url:"/admin/flash_sale/status",method:"put",data:e})},t.uploadCover=function(e){return o.a.post(i.c+"/upload/upload_flash_sale_cover",e,{headers:{"Content-Type":"multipart/form-data"}})};var a=r("vLgD"),n=r("I29D"),o=r.n(n),i=r("QmSG")},hoEO:function(e,t){},ql0N:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("lC5x"),n=r.n(a),o=r("J0Oq"),i=r.n(o),s=r("pIEA"),l=r.n(s),c=r("QmSG"),u=r("GKtG"),d=r("ZnMK"),m={name:"flaseSaleDetail",components:{VueUeditorWrap:l.a},data:function(){return{ueConfig:{autoHeightEnabled:!1,initialFrameHeight:640,initialFrameWidth:"100%",autoFloatEnabled:!1,serverUrl:c.b+"/upload/ue_upload",UEDITOR_HOME_URL:"/static/UEditor/"},form:{name:"",des:"",cover:"",over_time:"",old_price:0,now_price:0,content:"",bind_card_id:"",people:0,limit:10},cards:[],editStatus:!1}},mounted:function(){var e=this.$route.query.id;e&&(this.editStatus=!0,this.fetchDetail(e)),this.fetchCards()},methods:{fetchCards:function(){var e=this;return i()(n.a.mark(function t(){var r;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.all();case 2:200==(r=t.sent).code&&(e.cards=r.data);case 4:case"end":return t.stop()}},t,e)}))()},fetchDetail:function(e){var t=this;return i()(n.a.mark(function r(){var a;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,d.query({id:e});case 2:200==(a=r.sent).code&&(t.form=a.data);case 4:case"end":return r.stop()}},r,t)}))()},cardChange:function(){},uploadSectionFile:function(e){var t=this;return i()(n.a.mark(function r(){var a,o,i;return n.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a=e.file,(o=new FormData).append("file",a),r.next=5,d.uploadCover(o);case 5:i=r.sent,t.form.cover=i.data.data.imagePath;case 7:case"end":return r.stop()}},r,t)}))()},saveData:function(){var e=this;return i()(n.a.mark(function t(){var r,a,o,i,s,l,c,u,m,f,p,_,v;return n.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.$route.query.id,a=e.form,o=a.name,i=a.cover,s=a.now_price,l=a.old_price,c=a.bind_card_id,u=a.over_time,m=a.des,f=a.content,p=a.people,_=a.limit,o){t.next=5;break}return e.$message.error("请填写秒杀活动名称"),t.abrupt("return");case 5:if(i){t.next=8;break}return e.$message.error("请上传秒杀封面"),t.abrupt("return");case 8:if(l){t.next=11;break}return e.$message.error("请填写秒杀活动旧价格"),t.abrupt("return");case 11:if(s){t.next=14;break}return e.$message.error("请填写秒杀活动新价格"),t.abrupt("return");case 14:if(_){t.next=17;break}return e.$message.error("请填写秒杀活动共限制人数"),t.abrupt("return");case 17:if(c){t.next=20;break}return e.$message.error("请选择活动卡"),t.abrupt("return");case 20:if(u){t.next=23;break}return e.$message.error("请设置活动截止时间"),t.abrupt("return");case 23:if(m){t.next=26;break}return e.$message.error("请填写活动卡使用说明"),t.abrupt("return");case 26:if(f){t.next=29;break}return e.$message.error("请填写活动详细"),t.abrupt("return");case 29:if(v={},!e.editStatus){t.next=36;break}return t.next=33,d.edit({id:r,name:o,cover:i,now_price:s,old_price:l,bind_card_id:c,over_time:u,des:m,content:f,limit:_,people:p});case 33:v=t.sent,t.next=39;break;case 36:return t.next=38,d.add({name:o,cover:i,now_price:s,old_price:l,bind_card_id:c,over_time:u,des:m,people:p,limit:_,content:f});case 38:v=t.sent;case 39:200==v.code&&(e.$store.dispatch("tagsView/delView",e.$route),e.$router.push({path:"/actives/flash_sale"}));case 40:case"end":return t.stop()}},t,e)}))()}}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"wrap"},[r("el-form",{staticStyle:{"max-width":"1000px","padding-left":"30px"},attrs:{model:e.form,"label-position":"top"}},[r("el-form-item",{attrs:{required:"",label:"秒杀活动名称"}},[r("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"秒杀封面"}},[e.form.cover?r("img",{staticClass:"cover",attrs:{src:e.form.cover}}):r("div",{staticClass:"empty_pic"},[e._v("建议尺寸280×180，JPG、PNG、webp格式，图片小于5M。")]),e._v(" "),r("el-upload",{staticClass:"upload_box",attrs:{action:"fakeaction","show-file-list":!1,"auto-upload":!0,"http-request":e.uploadSectionFile}},[r("el-button",{attrs:{type:"info"}},[e._v("点击上传")]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("建议尺寸280×180，JPG、PNG、webp格式，图片小于5M。")])],1)],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"秒杀活动旧价格"}},[r("el-input-number",{model:{value:e.form.old_price,callback:function(t){e.$set(e.form,"old_price",t)},expression:"form.old_price"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"秒杀活动新价格"}},[r("el-input-number",{model:{value:e.form.now_price,callback:function(t){e.$set(e.form,"now_price",t)},expression:"form.now_price"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"已秒杀活动人数"}},[r("el-input-number",{model:{value:e.form.people,callback:function(t){e.$set(e.form,"people",t)},expression:"form.people"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"秒杀活动共限制人数"}},[r("el-input-number",{model:{value:e.form.limit,callback:function(t){e.$set(e.form,"limit",t)},expression:"form.limit"}})],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"选择活动卡"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"选择活动卡"},on:{change:e.cardChange},model:{value:e.form.bind_card_id,callback:function(t){e.$set(e.form,"bind_card_id",t)},expression:"form.bind_card_id"}},e._l(e.cards,function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{required:"",label:"活动截止时间"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择活动截止时间"},model:{value:e.form.over_time,callback:function(t){e.$set(e.form,"over_time",t)},expression:"form.over_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"活动卡使用说明"}},[r("el-input",{attrs:{type:"textarea",placeholder:"填写活动卡使用说明",maxlength:"255","show-word-limit":""},model:{value:e.form.des,callback:function(t){e.$set(e.form,"des",t)},expression:"form.des"}})],1),e._v(" "),r("el-form-item",{staticClass:"UEditor",attrs:{required:"",label:"活动详细"}},[r("VueUeditorWrap",{attrs:{config:e.ueConfig},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保 存 数 据")])],1)],1)],1)},staticRenderFns:[]};var p=r("C7Lr")(m,f,!1,function(e){r("hoEO")},"data-v-10b7feb2",null);t.default=p.exports}});