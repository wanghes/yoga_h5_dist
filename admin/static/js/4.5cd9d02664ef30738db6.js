webpackJsonp([4],{WJuX:function(e,t,a){e.exports=a.p+"static/img/id.d84f459.jpg"},YFNV:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("lC5x"),s=a.n(r),n=a("J0Oq"),i=a.n(n),o=a("pIEA"),c=a.n(o),l=a("QmSG"),d=a("0xDb"),u=a("VLUi"),p=a("QUe6"),m=a("ys0R"),f=a("WJuX"),_=a("GKtG"),v={components:{VueUeditorWrap:c.a},data:function(){return{activeName:"first",headDefault:m,idImg:f,sijiaoBindedCards:[],sijiao_price:0,ueConfig:{autoHeightEnabled:!1,initialFrameHeight:640,initialFrameWidth:"100%",autoFloatEnabled:!1,serverUrl:l.b+"/upload/ue_upload",UEDITOR_HOME_URL:"/static/UEditor/"},detail:{},form:{avatar:"",name:"",nickname:"",phone:"",jingyan:"",join_date:"",birthday:"",order:"",can_alone:0,id_card:"",des:"",content:""},multipleSelection:[],multipleTeacherCoursesSelection:[],teacherCourses:[]}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;return i()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.id,t.next=3,u.query({id:a});case 3:200==(r=t.sent).code&&(e.form=e.detail=r.data,e.sijiao_price=r.data.can_alone_price);case 5:case"end":return t.stop()}},t,e)}))()},uploadSectionFile:function(e){var t=this;return i()(s.a.mark(function a(){var r,n,i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.file,(n=new FormData).append("file",r),a.next=5,u.uploadHead(n);case 5:i=a.sent,t.form.avatar=i.data.data.imagePath;case 7:case"end":return a.stop()}},a,t)}))()},uploadIdSectionFile:function(e){var t=this;return i()(s.a.mark(function a(){var r,n,i;return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.file,(n=new FormData).append("idcard",r),a.next=5,u.uploadIdCard(n);case 5:i=a.sent,t.form.id_card=i.data.data.imagePath;case 7:case"end":return a.stop()}},a,t)}))()},fetchTeacherCourses:function(){var e=this;return i()(s.a.mark(function t(){var a,r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.id,t.next=3,p.teacher_courses({id:a});case 3:200==(r=t.sent).code&&(e.teacherCourses=r.data,e.$nextTick(function(){e.teacherCourses.forEach(function(t){t.course_price&&e.$refs.multipleCoursesTable.toggleRowSelection(t,!0)})}));case 5:case"end":return t.stop()}},t,e)}))()},cancelSubmit:function(){this.$store.dispatch("tagsView/delView",this.$route),this.$router.back(-1)},handleClick:function(e,t){"first"==e.name?this.fetchData():"second"==e.name?this.fetchSijiaoCardinfo():"third"==e.name&&this.fetchTeacherCourses()},fetchSijiaoCardinfo:function(){var e=this;return i()(s.a.mark(function t(){var a,r,n,i,o,c,l,d,p,m;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.id,t.next=3,u.sijiao_cardinfo({id:a});case 3:return r=t.sent,n=r.data.support_cardinfo,i=[],t.next=8,_.all();case 8:for(200==(o=t.sent).code&&(i=o.data.map(function(e){return{card_id:e.id,card_name:e.name,setted:"",card_type:e.type,check:!1}})),c=n.split(","),l=[],d=i.length,c.forEach(function(e){var t=e.split("_"),a={card_id:t[0],setted:t[1],check:!0};l.push(a)}),p=l.pop();p;){for(m=0;m<d;m++)i[m].card_id==p.card_id&&(p.card_name=i[m].card_name,p.card_type=i[m].card_type,i.splice(m,1,p));p=l.pop()}e.sijiaoBindedCards=i,e.$nextTick(function(){e.sijiaoBindedCards.forEach(function(t){t.check&&e.$refs.multipleTable.toggleRowSelection(t,!0)})});case 18:case"end":return t.stop()}},t,e)}))()},saveData:function(){var e=this;return i()(s.a.mark(function t(){var a,r,n,i,o,c,l,p,m,f,_,v,h,b;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$route.params.id,r=e.form,n=r.avatar,i=r.name,o=r.nickname,c=r.phone,l=r.jingyan,p=r.join_date,m=r.birthday,f=r.order,_=r.can_alone,v=r.id_card,h=r.des,b=r.content,i){t.next=6;break}e.$message.error("老师姓名不能为空"),t.next=24;break;case 6:if(c){t.next=10;break}e.$message.error("老师手机号不能为空"),t.next=24;break;case 10:if(!(f&&f<0)){t.next=14;break}e.$message.error("正确填写显示顺序"),t.next=24;break;case 14:if(h){t.next=18;break}e.$message.error("请填写一句话描述"),t.next=24;break;case 18:return p&&(p=Object(d.b)("YYYY-mm-dd HH:MM:SS",new Date(p))),m&&(m=Object(d.b)("YYYY-mm-dd HH:MM:SS",new Date(m))),t.next=22,u.update({id:a,avatar:n,name:i,nickname:o,phone:c,jingyan:l,join_date:p,birthday:m,order:f,can_alone:_,id_card:v,des:h,content:b});case 22:200==t.sent.code?(e.$store.dispatch("tagsView/delView",e.$route),e.$router.replace({path:"/offline/teacher"})):Message.error("数据保存失败");case 24:case"end":return t.stop()}},t,e)}))()},handleSelectionTeacherCoursesChange:function(e){this.multipleTeacherCoursesSelection=e},handleSelectionChange:function(e){this.multipleSelection=e},saveAllBinds:function(){var e=this;return i()(s.a.mark(function t(){var a,r,n,i,o,c,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$route.params.id,(r=e.multipleSelection).length){t.next=5;break}return e.$message.error("选择要设置的卡"),t.abrupt("return");case 5:n=!0,i=0;case 7:if(!(i<r.length)){t.next=15;break}if((o=r[i]).setted||1!=o.card_type&&6!=o.card_type&&7!=o.card_type){t.next=12;break}return n=!1,t.abrupt("break",15);case 12:i++,t.next=7;break;case 15:if(n){t.next=18;break}return e.$message.error("设置单位数量"),t.abrupt("return");case 18:return c=[],r.forEach(function(e){var t="";t=6==e.card_type?parseFloat(e.setted).toFixed(2):e.setted,c.push(e.card_id+"_"+t)}),c=c.join(","),t.next=24,u.set_sijiao_cardinfo({id:a,support_cardinfo:c});case 24:200==(l=t.sent).code&&(e.$message.success(l.msg),e.fetchSijiaoCardinfo());case 26:case"end":return t.stop()}},t,e)}))()},saveTeacherPricesAllBinds:function(){var e=this;return i()(s.a.mark(function t(){var a,r,n,i,o,c;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if((a=e.multipleTeacherCoursesSelection).length){t.next=4;break}return e.$message.error("选择要设置的课程"),t.abrupt("return");case 4:r=!0,n=0;case 6:if(!(n<a.length)){t.next=14;break}if((i=a[n]).course_price&&i.must_course_num){t.next=11;break}return r=!1,t.abrupt("break",14);case 11:n++,t.next=6;break;case 14:if(r){t.next=17;break}return e.$message.error("请填写选中的并且不能为0或者空"),t.abrupt("return");case 17:return o=[],a.forEach(function(e){o.push(e.teacher_id+":"+e.agree_id+":"+parseFloat(e.course_price).toFixed(2)+":"+e.must_course_num)}),t.next=21,u.teacher_courses_price({prices:o});case 21:200==(c=t.sent).code?(e.$message.success(c.msg),e.fetchTeacherCourses()):(e.$message.error("设置失败"),console.log(c));case 23:case"end":return t.stop()}},t,e)}))()},saveSijiaoPrice:function(){var e=this;return i()(s.a.mark(function t(){var a,r,n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.id,r=e.sijiao_price,t.next=4,u.set_alone_price({id:a,can_alone_price:r});case 4:200==(n=t.sent).code?(e.$message.success(n.msg),e.fetchData()):(e.$message.error("设置失败"),console.log(n));case 6:case"end":return t.stop()}},t,e)}))()}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap"},[a("div",{staticClass:"top"},[a("div",{staticClass:"top_left"},[a("div",{staticClass:"head"},[e.form.avatar?a("img",{attrs:{src:e.form.avatar,alt:"头像"}}):a("img",{attrs:{src:e.headDefault,alt:"头像"}})]),e._v(" "),a("div",{staticClass:"center"},[a("div",{staticClass:"item"},[a("label",[e._v("姓名：")]),a("span",[e._v(e._s(e.form.name))])]),e._v(" "),a("div",{staticClass:"item"},[a("label",[e._v("昵称：")]),a("span",[e._v(e._s(e.form.nickname))])]),e._v(" "),a("div",{staticClass:"item"},[a("label",[e._v("电话：")]),a("span",[e._v(e._s(e.form.phone))])])]),e._v(" "),a("div",{staticClass:"center_right"},[a("div",{staticClass:"item"},[a("label",[e._v("从业经验：")]),e._v(" "),e.form.jingyan?a("span",{staticClass:"jingyan"},[e._v(e._s(e.form.jingyan))]):a("span",{staticClass:"jingyan"},[e._v("目前还没有设置老师的经验")])]),e._v(" "),a("div",{staticClass:"item"},[a("label",[e._v("入职时间：")]),a("span",[e._v(e._s(e.form.join_date.slice(0,10)))])]),e._v(" "),a("div",{staticClass:"item"},[a("label",[e._v("显示顺序：")]),a("span",[e._v(e._s(e.form.order))])])])]),e._v(" "),a("div",{staticClass:"btns"},[a("el-button",{attrs:{type:"primary"}},[e._v("编辑")])],1)]),e._v(" "),a("el-divider"),e._v(" "),a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("el-form",{staticStyle:{"max-width":"1200px","padding-left":"30px"},attrs:{model:e.form,"label-position":"top"}},[a("el-form-item",{attrs:{label:"老师头像"}},[e.form.avatar?a("img",{staticClass:"head_cover",attrs:{src:e.form.avatar}}):a("img",{staticClass:"head_cover",attrs:{src:e.headDefault}}),e._v(" "),a("el-upload",{staticClass:"upload_box",attrs:{action:"fakeaction","show-file-list":!1,"auto-upload":!0,"http-request":e.uploadSectionFile}},[a("el-button",{attrs:{type:"info"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("建议尺寸200×200，gif、jpg、jpeg、png格式，图片小于5M。")])],1)],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"姓名"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"手机"}},[a("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"昵称"}},[a("el-input",{model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"入职时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.join_date,callback:function(t){e.$set(e.form,"join_date",t)},expression:"form.join_date"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"生日"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"显示顺序"}},[a("el-input-number",{model:{value:e.form.order,callback:function(t){e.$set(e.form,"order",t)},expression:"form.order"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否支持私教"}},[a("el-radio-group",{model:{value:e.form.can_alone,callback:function(t){e.$set(e.form,"can_alone",t)},expression:"form.can_alone"}},[a("el-radio",{attrs:{label:0}},[e._v("不支持")]),e._v(" "),a("el-radio",{attrs:{label:1}},[e._v("支持")])],1)],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"一句话描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"填写一句话描述",maxlength:"100"},model:{value:e.form.des,callback:function(t){e.$set(e.form,"des",t)},expression:"form.des"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"教学经验"}},[a("el-input",{attrs:{type:"textarea",placeholder:"填写教学经验",maxlength:"255"},model:{value:e.form.jingyan,callback:function(t){e.$set(e.form,"jingyan",t)},expression:"form.jingyan"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"身份证照"}},[e.form.id_card?a("img",{staticClass:"id_img",attrs:{src:e.form.id_card}}):a("div",{staticClass:"empty_pic"},[e._v("建议尺寸400×250，gif、jpg、jpeg、png格式，图片小于5M。")]),e._v(" "),a("el-upload",{staticClass:"upload_box",attrs:{action:"action","show-file-list":!1,"auto-upload":!0,"http-request":e.uploadIdSectionFile}},[a("el-button",{attrs:{type:"info"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("建议尺寸400×250，gif、jpg、jpeg、png格式，图片小于5M。")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"详细介绍"}},[a("VueUeditorWrap",{staticClass:"UEditor",attrs:{config:e.ueConfig},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保 存 数 据")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.cancelSubmit}},[e._v("取消")])],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"私教预约设置",name:"second"}},[1==e.detail.can_alone?a("div",{staticClass:"shezhi"},[a("el-table",{ref:"multipleTable",attrs:{data:e.sijiaoBindedCards,"tooltip-effect":"dark","header-cell-style":{color:"#333","background-color":"#f5f5f5"}},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"card_name",label:"支持预约的会员卡",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"setted",label:"单位消费数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.card_type?a("div",{staticClass:"per_box"},[a("el-input-number",{attrs:{placeholder:"请输入单位消费数量"},model:{value:t.row.setted,callback:function(a){e.$set(t.row,"setted",a)},expression:"scope.row.setted"}}),e._v(" "),a("span",[e._v("次")])],1):e._e(),e._v(" "),6==t.row.card_type?a("div",{staticClass:"per_box"},[a("el-input-number",{attrs:{placeholder:"请输入单位消费数量"},model:{value:t.row.setted,callback:function(a){e.$set(t.row,"setted",a)},expression:"scope.row.setted"}}),e._v(" "),a("span",[e._v("元/小时")])],1):a("div")]}}],null,!1,2791714238)})],1),e._v(" "),a("div",{staticClass:"b_btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveAllBinds}},[e._v("保 存")])],1)],1):a("el-alert",{attrs:{title:"目前该老师还不支持私教课",closable:!1,type:"error"}})],1),e._v(" "),a("el-tab-pane",{attrs:{label:"设置课时费用",name:"third"}},[a("div",{staticClass:"inner_box"},[a("h3",[e._v("团课课时费设置")])]),e._v(" "),e.teacherCourses.length?a("div",{staticClass:"content_box"},[a("el-table",{ref:"multipleCoursesTable",attrs:{data:e.teacherCourses,"tooltip-effect":"dark","header-cell-style":{color:"#333","background-color":"#f5f5f5"}},on:{"selection-change":e.handleSelectionTeacherCoursesChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"course_name",label:"团课项目",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{prop:"must_course_num",label:"每月义务授课节数",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"per_box"},[a("el-input-number",{attrs:{placeholder:"每月义务授课节数"},model:{value:t.row.must_course_num,callback:function(a){e.$set(t.row,"must_course_num",a)},expression:"scope.row.must_course_num"}}),e._v(" "),a("span",[e._v("节")])],1)]}}],null,!1,2080495538)}),e._v(" "),a("el-table-column",{attrs:{prop:"course_price",label:"基本课时费"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"per_box"},[a("el-input-number",{attrs:{placeholder:"基本课时费"},model:{value:t.row.course_price,callback:function(a){e.$set(t.row,"course_price",a)},expression:"scope.row.course_price"}}),e._v(" "),a("span",[e._v("元/节")])],1)]}}],null,!1,3207612969)})],1),e._v(" "),a("div",{staticClass:"b_btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveTeacherPricesAllBinds}},[e._v("保 存")])],1)],1):a("div",[a("el-alert",{attrs:{title:"还没有给老师排课，快去排课吧",type:"error"}})],1),e._v(" "),a("el-divider"),e._v(" "),a("div",{staticClass:"inner_box"},[a("h3",[e._v("私教课时费设置")])]),e._v(" "),1==e.detail.can_alone?a("div",[a("el-input-number",{attrs:{placeholder:"私教课时费"},model:{value:e.sijiao_price,callback:function(t){e.sijiao_price=t},expression:"sijiao_price"}}),e._v(" "),a("span",[e._v("元/节")]),e._v(" "),a("div",{staticClass:"b_btn"},[a("el-button",{attrs:{type:"primary"},on:{click:e.saveSijiaoPrice}},[e._v("保 存")])],1)],1):a("div",[a("el-alert",{attrs:{title:"目前该老师还不支持私教课",type:"error"}})],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"评价",name:"fourth"}},[a("el-alert",{attrs:{title:"功能开发中，敬请期待",type:"info"}})],1)],1)],1)},staticRenderFns:[]};var b=a("C7Lr")(v,h,!1,function(e){a("w4uC")},"data-v-7acaec8c",null);t.default=b.exports},w4uC:function(e,t){}});