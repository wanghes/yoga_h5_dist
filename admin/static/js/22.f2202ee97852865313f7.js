webpackJsonp([22],{ANoM:function(e,t){},bWPM:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("lC5x"),s=a.n(n),r=a("J0Oq"),l=a.n(r),o=a("GKtG"),c={data:function(){return{list:[],currentPage:1,pageSize:15,total:0,searchForm:{status:"",type:"",name:""},status:[{value:1,label:"可售"},{value:0,label:"不可售"}],types:[{value:1,label:"次卡"},{value:2,label:"年卡"},{value:3,label:"季卡"},{value:4,label:"月卡"},{value:5,label:"周卡"},{value:6,label:"储值卡"},{value:7,label:"小时卡"}]}},mounted:function(){this.fetchData()},methods:{fetchData:function(){var e=this;return l()(s.a.mark(function t(){var a,n,r,l,c,u,i,p;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.searchForm,n=a.name,r=a.type,l=a.status,t.next=3,o.list({pageSize:e.pageSize,page:e.currentPage,name:n,type:r,status:l});case 3:200==(c=t.sent).code&&(u=c.data,i=u.list,p=u.total,i.forEach(function(e){e.status=1==e.status}),e.list=i,e.total=p);case 5:case"end":return t.stop()}},t,e)}))()},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},handleCurrentChange:function(e){this.currentPage=e,this.fetchData()},changeSwitchStatus:function(e){var t=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.updateStatus({id:e.id,status:e.status?1:0});case 2:a.sent.code&&t.$message.success("修改成功");case 4:case"end":return a.stop()}},a,t)}))()},editItem:function(e){var t=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:t.$router.push({path:"/card/edit/"+e});case 1:case"end":return a.stop()}},a,t)}))()},deleteItem:function(e){var t=this;return l()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,o.deleteItem({id:e});case 2:200==a.sent.code&&(t.$message.success("操作成功"),t.fetchData());case 4:case"end":return a.stop()}},a,t)}))()},toAdd:function(){this.$router.push({path:"/card/add"})},statusChange:function(){this.fetchData()},typeChange:function(){this.fetchData()},nameChange:function(){this.fetchData()}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap"},[a("div",{staticClass:"top_info"},[a("div",{staticClass:"left_search"},[a("el-select",{attrs:{clearable:"",placeholder:"卡可售状态"},on:{change:e.statusChange},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},e._l(e.status,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-select",{attrs:{clearable:"",placeholder:"卡类别"},on:{change:e.typeChange},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},e._l(e.types,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-input",{staticClass:"input_search",attrs:{placeholder:"请填写卡种名称",clearable:""},on:{clear:e.nameChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nameChange(t)}},model:{value:e.searchForm.name,callback:function(t){e.$set(e.searchForm,"name",t)},expression:"searchForm.name"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:e.nameChange},slot:"suffix"})])],1),e._v(" "),a("el-button-group",{staticClass:"btn_wrap"},[a("el-button",{attrs:{type:"primary"},on:{click:e.toAdd}},[e._v("新建卡种")])],1)],1),e._v(" "),a("el-table",{attrs:{data:e.list,"header-cell-style":{color:"#333","background-color":"#f5f5f5"}}},[a("el-table-column",{attrs:{width:"180",label:"卡种类封面"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("div",{staticClass:"card_wrap"},[a("img",{attrs:{width:"150",src:e.row.cover,alt:""}})])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"name",width:"200",label:"卡种类名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",width:"80",label:"卡类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.type?a("span",[e._v("次卡")]):e._e(),e._v(" "),2==t.row.type?a("span",[e._v("年卡")]):e._e(),e._v(" "),3==t.row.type?a("span",[e._v("季卡")]):e._e(),e._v(" "),4==t.row.type?a("span",[e._v("月卡")]):e._e(),e._v(" "),5==t.row.type?a("span",[e._v("周卡")]):e._e(),e._v(" "),6==t.row.type?a("span",[e._v("储值卡")]):e._e(),e._v(" "),7==t.row.type?a("span",[e._v("小时卡")]):e._e()]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"price",width:"130",label:"价值(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("￥"+e._s(t.row.price.toFixed(2)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"expire_date_on",width:"120",label:"卡有效期(天)"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.expire_date_on?a("span",[e._v(e._s(t.row.expire_date)+"天")]):a("span",[e._v("不限")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"times",width:"100",label:"上课次数"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.times>0?a("span",[e._v(e._s(t.row.times))]):a("span",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"hours",width:"100",label:"上课小时数"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.hours>0?a("span",[e._v(e._s(t.row.hours))]):a("span",[e._v("--")])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"150",label:"限制上课的人数"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v("仅限 "),a("strong",{staticClass:"limit_people"},[e._v(e._s(t.row.limit_people))]),e._v(" 人使用")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"order",width:"80",label:"显示顺序"}}),e._v(" "),a("el-table-column",{attrs:{width:"150",label:"绑定的课程"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.count>0?a("span",[e._v("已绑定 "),a("strong",{staticClass:"limit_people"},[e._v(e._s(t.row.count))]),e._v(" 门课程")]):a("span",[e._v("未绑定课程")])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"status",fit:"",label:"可售状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{on:{change:function(a){return e.changeSwitchStatus(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.editItem(t.row.id)}}},[e._v("编辑")]),e._v(" "),a("el-popover",{attrs:{placement:"top",trigger:"click",width:160}},[a("div",{staticStyle:{"margin-bottom":"10px"}},[a("span",[e._v("你确定要删除该卡种吗？")])]),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"0"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.deleteItem(t.row.id)}}},[e._v("确定")])],1),e._v(" "),a("template",{slot:"reference"},[a("el-button",{attrs:{size:"mini",type:"danger"}},[e._v("删除")])],1)],2)]}}])})],1),e._v(" "),a("div",{staticStyle:{"text-align":"center",margin:"30px 0"}},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":e.currentPage,"page-sizes":[15,30,50],"page-size":e.pageSize,total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var i=a("C7Lr")(c,u,!1,function(e){a("ANoM")},"data-v-e2d6e13a",null);t.default=i.exports}});