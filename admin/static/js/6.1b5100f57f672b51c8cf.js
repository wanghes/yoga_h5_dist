webpackJsonp([6],{FNhj:function(e,t,a){e.exports=a.p+"static/img/xilie_cover.f167438.png"},G7f9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("lC5x"),o=a.n(r),n=a("J0Oq"),i=a.n(n),s=a("pIEA"),c=a.n(s),l=a("QmSG"),u=a("q7OS"),p=a("h0S9"),m=a("FNhj"),_={name:"CourseAloneDetail",components:{VueUeditorWrap:c.a},data:function(){return{activeName:"first",formLabelWidth:"130",course_cover:m,visible:!1,cate_selected:"",cates:[],ueConfig:{autoHeightEnabled:!1,initialFrameHeight:640,initialFrameWidth:"100%",autoFloatEnabled:!1,serverUrl:l.b+"/upload/ue_upload",UEDITOR_HOME_URL:"/static/UEditor/"},form:{course_name:"",course_num:"",course_cate:"",course_cover:"",pay_type:"",course_content:"",pay_money_type:[]},pickerOptions:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},payTypes:[{id:1,name:"固定收费"},{id:2,name:"按天收费"},{id:3,name:"按月收费"},{id:4,name:"按年收费"}]}},mounted:function(){this.fetData()},methods:{fetData:function(){var e=this;return i()(o.a.mark(function t(){var a,r,n;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$route.params.id,t.next=3,p.get_manycourse({id:a});case 3:return r=t.sent,t.next=6,p.getCates();case 6:n=t.sent,e.cates=n.data,r.data.course_cate=0==r.data.course_cate?"":r.data.course_cate,e.form=r.data;case 10:case"end":return t.stop()}},t,e)}))()},saveData:function(){var e=this;return i()(o.a.mark(function t(){var a,r,n,i,s,c,l,m,_,d,f;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$route.params.id,r=e.form,n=r.course_name,i=r.course_num,s=r.course_cate,c=r.course_cover,l=r.course_content,m=r.pay_type,_=r.pay_money_type,n){t.next=5;break}return u.Message.error("课程主题不能为空"),t.abrupt("return");case 5:if(i){t.next=8;break}return u.Message.error("请设置排课计划"),t.abrupt("return");case 8:if(s){t.next=11;break}return u.Message.error("请选择课程分类"),t.abrupt("return");case 11:if(c){t.next=14;break}return u.Message.error("请上传课程封面"),t.abrupt("return");case 14:if(l){t.next=17;break}return u.Message.error("请填写课程内容"),t.abrupt("return");case 17:if(1!=m){t.next=23;break}if(d=!1,_.forEach(function(e){e.price||(d=!0)}),!d){t.next=23;break}return u.Message.error("请正确填写金额相关输入框"),t.abrupt("return");case 23:if(1==m){t.next=29;break}if(f=!1,_.forEach(function(e){(e.time<=0||!e.price)&&(f=!0)}),!f){t.next=29;break}return u.Message.error("请正确填写金额相关输入框"),t.abrupt("return");case 29:return t.next=31,p.many_done({id:a,course_name:n,course_num:i,course_cate:s,course_cover:c,course_content:l,pay_type:m,pay_money_type:_});case 31:200==t.sent.code?(e.$store.dispatch("tagsView/delView",e.$route),e.$router.replace({path:"/course/many_index"})):u.Message.error("数据保存失败");case 33:case"end":return t.stop()}},t,e)}))()},cateChange:function(e){console.log(e)},uploadSectionFile:function(e){var t=this;return i()(o.a.mark(function a(){var r,n,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r=e.file,(n=new FormData).append("file",r),a.next=5,p.uploadAloneCover(n);case 5:i=a.sent,t.form.course_cover=i.data.data.imagePath;case 7:case"end":return a.stop()}},a,t)}))()},addTypeByTime:function(){this.form.pay_money_type.push({time:"",price:""})},delPayMonnyItem:function(e){this.form.pay_money_type.splice(e,1),console.log(this.form.pay_money_type)}}},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"课程编辑",name:"first"}},[a("el-form",{staticStyle:{"max-width":"1200px","padding-left":"30px"},attrs:{model:e.form,"label-position":"top"}},[a("el-form-item",{attrs:{required:"",label:"系列课名称","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.course_name,callback:function(t){e.$set(e.form,"course_name",t)},expression:"form.course_name"}})],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"排课计划","label-width":e.formLabelWidth}},[a("el-input-number",{attrs:{min:1,max:100,label:"排课计划"},model:{value:e.form.course_num,callback:function(t){e.$set(e.form,"course_num",t)},expression:"form.course_num"}})],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"系列课分类","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.cateChange},model:{value:e.form.course_cate,callback:function(t){e.$set(e.form,"course_cate",t)},expression:"form.course_cate"}},e._l(e.cates,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"课程封面","label-width":e.formLabelWidth}},[a("div",{staticClass:"cover"},[e.form.course_cover?a("img",{attrs:{src:e.form.course_cover}}):a("div",{staticClass:"empty_pic"},[e._v("建议尺寸280×180，JPG、PNG、webp格式，图片小于5M。")])]),e._v(" "),a("el-upload",{staticClass:"upload_box",attrs:{action:"fakeaction","show-file-list":!1,"auto-upload":!0,"http-request":e.uploadSectionFile}},[a("el-button",{attrs:{type:"danger"}},[e._v("点击上传")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("建议尺寸280×180，JPG、PNG、webp格式，图片小于5M。")])],1)],1),e._v(" "),a("el-form-item",{attrs:{required:"",label:"收费类型","label-width":e.formLabelWidth}},[a("el-radio-group",{model:{value:e.form.pay_type,callback:function(t){e.$set(e.form,"pay_type",t)},expression:"form.pay_type"}},e._l(e.payTypes,function(t){return a("el-radio",{key:t.id,attrs:{disabled:t.id!=e.form.pay_type,label:t.id}},[e._v(e._s(t.name))])}),1),e._v(" "),1==e.form.pay_type?a("div",{staticClass:"pay_money_box"},e._l(e.form.pay_money_type,function(t,r){return a("div",{key:r},[a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")])],1)}),0):a("div",{staticClass:"pay_money_box"},[2==e.form.pay_type?a("div",e._l(e.form.pay_money_type,function(t,r){return a("div",{key:r,staticClass:"pay_money_type_item"},[a("el-input-number",{staticClass:"short_input",model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}}),e._v(" "),a("span",[e._v(" 天收取")]),e._v(" "),a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")]),e._v(" "),0!=r?a("el-link",{staticClass:"del_btn",attrs:{type:"danger"},on:{click:function(t){return e.delPayMonnyItem(r)}}},[e._v("删除")]):e._e()],1)}),0):3==e.form.pay_type?a("div",e._l(e.form.pay_money_type,function(t,r){return a("div",{key:r,staticClass:"pay_money_type_item"},[a("el-input-number",{staticClass:"short_input",model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}}),e._v(" "),a("span",[e._v(" 月收取")]),e._v(" "),a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")]),e._v(" "),0!=r?a("el-link",{staticClass:"del_btn",attrs:{type:"danger"},on:{click:function(t){return e.delPayMonnyItem(r)}}},[e._v("删除")]):e._e()],1)}),0):4==e.form.pay_type?a("div",e._l(e.form.pay_money_type,function(t,r){return a("div",{key:r,staticClass:"pay_money_type_item"},[a("el-input-number",{staticClass:"short_input",model:{value:t.time,callback:function(a){e.$set(t,"time",a)},expression:"item.time"}}),e._v(" "),a("span",[e._v(" 年收取")]),e._v(" "),a("el-input",{staticClass:"short_input",model:{value:t.price,callback:function(a){e.$set(t,"price",a)},expression:"item.price"}}),e._v(" "),a("span",[e._v(" 元")]),e._v(" "),0!=r?a("el-link",{staticClass:"del_btn",attrs:{type:"danger"},on:{click:function(t){return e.delPayMonnyItem(r)}}},[e._v("删除")]):e._e()],1)}),0):e._e(),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.addTypeByTime}},[e._v("添加一个类型")])],1)],1),e._v(" "),a("el-form-item",{staticClass:"UEditor",attrs:{required:"",label:"课程内容","label-width":e.formLabelWidth}},[a("VueUeditorWrap",{attrs:{config:e.ueConfig},model:{value:e.form.course_content,callback:function(t){e.$set(e.form,"course_content",t)},expression:"form.course_content"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保 存 数 据")])],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"播放视频",visible:e.visible,width:"40%"},on:{"update:visible":function(t){e.visible=t}}},[a("video",{attrs:{src:e.form.course_video,controls:"",width:"100%",height:"100%",autoPlay:"","data-setup":"{}"}},[a("source",{attrs:{src:e.form.course_video}})]),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("关 闭")])],1)])],1)},staticRenderFns:[]};var f=a("C7Lr")(_,d,!1,function(e){a("zAdV")},"data-v-76429db9",null);t.default=f.exports},zAdV:function(e,t){}});