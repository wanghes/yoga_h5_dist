webpackJsonp([21],{R5tY:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("lC5x"),r=i.n(a),s=i("J0Oq"),n=i.n(s),l=i("pIEA"),o=i.n(l),m=i("QmSG"),c=i("ZumN"),u=i("s067"),p={components:{VueUeditorWrap:o.a},data:function(){return{cover:u,showLimit:!0,ueConfig:{autoHeightEnabled:!1,initialFrameHeight:640,initialFrameWidth:"100%",autoFloatEnabled:!1,serverUrl:m.b+"/upload/ue_upload",UEDITOR_HOME_URL:"/static/UEditor/"},form:{id:"",name:"",tiyan:0,cover:"",des:"",content:"",order_limit_status:1,order_limit_type:1,cancle_limit_hour:"",order_limit_hour:""},limits:{tian:"",prev:"",next:""},type1:!0,type2:!1,type3:!1}},mounted:function(){this.fetData()},methods:{fetData:function(){var e=this;return n()(r.a.mark(function t(){var i,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.$route.params.id,t.next=3,c.query({id:i});case 3:a=t.sent,console.log(a.data),e.form=a.data,e.setLimit(a.data.date_time_limit),e.changeLimitType(a.data.order_limit_type);case 8:case"end":return t.stop()}},t,e)}))()},setLimit:function(e){if(e&&(e=e.split(":")),3==e.length){var t=e[0],i=e[1],a=e[2];this.limits={tian:t,prev:i,next:a}}else if(2==e.length){var r=e[0],s=e[1];this.limits={tian:r,prev:"",next:s}}else if(1==e.length){var n=e[0];this.limits={prev:n}}},uploadSectionFile:function(e){var t=this;return n()(r.a.mark(function i(){var a,s,n;return r.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return a=e.file,(s=new FormData).append("file",a),i.next=5,c.uploadTuankeCover(s);case 5:n=i.sent,t.form.cover=n.data.data.imagePath;case 7:case"end":return i.stop()}},i,t)}))()},changeLimit:function(e){this.showLimit=1==e},changeLimitType:function(e){this.type1=!1,this.type2=!1,this.type3=!1,1==e?this.type1=!0:2==e?this.type2=!0:3==e&&(this.type3=!0)},saveData:function(){var e=this;return n()(r.a.mark(function t(){var i,a,s,n,l,o,m,u,p,v,_,d;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.$route.params.id,a=e.form,s=a.name,n=a.tiyan,l=a.cover,o=a.des,m=a.content,u=a.order_limit_status,p=a.order_limit_type,v=a.cancle_limit_hour,_=a.order_limit_hour,d="",s){t.next=6;break}return e.$message.error("团课名字不能为空"),t.abrupt("return");case 6:if(1!=u){t.next=35;break}if(1!=p){t.next=14;break}if(e.limits.tian&&e.limits.prev&&e.limits.next){t.next=11;break}return e.$message.error("限制预约时间必填"),t.abrupt("return");case 11:d=[e.limits.tian,e.limits.prev,e.limits.next].join(":"),t.next=26;break;case 14:if(2!=p){t.next=21;break}if(e.limits.tian&&e.limits.next){t.next=18;break}return e.$message.error("限制预约时间必填"),t.abrupt("return");case 18:d=[e.limits.tian,e.limits.next].join(":"),t.next=26;break;case 21:if(3!=p){t.next=26;break}if(e.limits.next){t.next=25;break}return e.$message.error("限制预约时间必填"),t.abrupt("return");case 25:d=[e.limits.prev].join(":");case 26:if(v){t.next=29;break}return e.$message.error("取消预约必填"),t.abrupt("return");case 29:if(_){t.next=32;break}return e.$message.error("预约截止必填"),t.abrupt("return");case 32:if(!(_>e.limits.prev)){t.next=35;break}return e.$message.error("预约截止时间必须小于预约时间"),t.abrupt("return");case 35:if(l){t.next=39;break}e.$message.error("请上传课程封面"),t.next=51;break;case 39:if(o){t.next=43;break}e.$message.error("请填写描述内容"),t.next=51;break;case 43:if(m){t.next=47;break}e.$message.error("请填写课程内容"),t.next=51;break;case 47:return t.next=49,c.update({id:i,name:s,tiyan:n,cover:l,des:o,content:m,date_time_limit:d,order_limit_status:u,cancle_limit_hour:v,order_limit_type:p,order_limit_hour:_});case 49:200==t.sent.code?(e.$store.dispatch("tagsView/delView",e.$route),e.$router.replace({path:"/offline/index",query:{name:"tuanke"}})):Message.error("数据更新失败");case 51:case"end":return t.stop()}},t,e)}))()}}},v={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"wrap"},[i("el-form",{staticStyle:{"max-width":"1200px","padding-left":"30px"},attrs:{model:e.form,"label-position":"top"}},[i("el-form-item",{attrs:{required:"",label:"团课项目名称"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"限制预约时间"}},[i("el-radio-group",{on:{change:e.changeLimit},model:{value:e.form.order_limit_status,callback:function(t){e.$set(e.form,"order_limit_status",t)},expression:"form.order_limit_status"}},[i("el-radio",{attrs:{label:1}},[e._v("限制预约时间")]),e._v(" "),i("el-radio",{attrs:{label:0}},[e._v("不限制预约时间")])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showLimit,expression:"showLimit"}],staticClass:"limit_box"},[i("h5",{staticClass:"tit"},[e._v("预约时间:")]),e._v(" "),i("el-radio-group",{attrs:{size:"mini"},on:{change:e.changeLimitType},model:{value:e.form.order_limit_type,callback:function(t){e.$set(e.form,"order_limit_type",t)},expression:"form.order_limit_type"}},[i("el-radio",{attrs:{label:1,border:""}},[e._v("方案一")]),e._v(" "),i("el-radio",{attrs:{label:2,border:""}},[e._v("方案二")]),e._v(" "),i("el-radio",{attrs:{label:3,border:""}},[e._v("方案三")])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.type1,expression:"type1"}],staticClass:"d_box"},[i("div",{staticClass:"item"},[i("span",[e._v("提前")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.limits.tian,callback:function(t){e.$set(e.limits,"tian",t)},expression:"limits.tian"}}),e._v(" "),i("span",[e._v("天")])],1),e._v(" "),i("div",{staticClass:"item"},[i("span",[e._v("从")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.limits.prev,callback:function(t){e.$set(e.limits,"prev",t)},expression:"limits.prev"}}),e._v(" "),i("span",[e._v("点到")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.limits.next,callback:function(t){e.$set(e.limits,"next",t)},expression:"limits.next"}}),e._v(" "),i("span",[e._v("点接受预约")])],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.type2,expression:"type2"}],staticClass:"d_box"},[i("div",{staticClass:"item"},[i("span",[e._v("提前")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.limits.tian,callback:function(t){e.$set(e.limits,"tian",t)},expression:"limits.tian"}}),e._v(" "),i("span",[e._v("天")])],1),e._v(" "),i("div",{staticClass:"item"},[i("span",[e._v("从")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.limits.next,callback:function(t){e.$set(e.limits,"next",t)},expression:"limits.next"}}),e._v(" "),i("span",[e._v("点后接受预约")])],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.type3,expression:"type3"}],staticClass:"d_box"},[i("div",{staticClass:"item"},[i("span",[e._v("开课前")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.limits.prev,callback:function(t){e.$set(e.limits,"prev",t)},expression:"limits.prev"}}),e._v(" "),i("span",[e._v("小时接受预约")])],1)]),e._v(" "),i("h5",{staticClass:"tit"},[e._v("取消预约:")]),e._v(" "),i("div",{staticClass:"d_box"},[i("span",[e._v("开课前")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.form.cancle_limit_hour,callback:function(t){e.$set(e.form,"cancle_limit_hour",t)},expression:"form.cancle_limit_hour"}}),e._v(" "),i("span",[e._v("个小时可取消")])],1),e._v(" "),i("h5",{staticClass:"tit"},[e._v("预约截止:")]),e._v(" "),i("div",{staticClass:"d_box"},[i("span",[e._v("开课前")]),e._v(" "),i("el-input",{staticClass:"duan_input",model:{value:e.form.order_limit_hour,callback:function(t){e.$set(e.form,"order_limit_hour",t)},expression:"form.order_limit_hour"}}),e._v(" "),i("span",[e._v("个小时截止")])],1)],1)],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"是否支持体验课"}},[i("el-radio-group",{model:{value:e.form.tiyan,callback:function(t){e.$set(e.form,"tiyan",t)},expression:"form.tiyan"}},[i("el-radio",{attrs:{label:0}},[e._v("不支持")]),e._v(" "),i("el-radio",{attrs:{label:1}},[e._v("支持")])],1)],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"团课封面"}},[e.form.cover?i("img",{attrs:{src:e.form.cover}}):i("img",{attrs:{src:e.cover}}),e._v(" "),i("el-upload",{staticClass:"upload_box",attrs:{action:"fakeaction","show-file-list":!1,"auto-upload":!0,"http-request":e.uploadSectionFile}},[i("el-button",{attrs:{type:"danger"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("建议尺寸800*500px，JPG、PNG、webp格式，图片小于5M。")])],1)],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"团课描述"}},[i("el-input",{model:{value:e.form.des,callback:function(t){e.$set(e.form,"des",t)},expression:"form.des"}})],1),e._v(" "),i("el-form-item",{attrs:{required:"",label:"团课内容"}},[i("VueUeditorWrap",{staticClass:"UEditor",attrs:{config:e.ueConfig},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),e._v(" "),i("el-form-item",[i("el-button",{attrs:{type:"primary"},on:{click:e.saveData}},[e._v("保 存 数 据")])],1)],1)],1)},staticRenderFns:[]};var _=i("C7Lr")(p,v,!1,function(e){i("wSF7")},"data-v-33ce8cb4",null);t.default=_.exports},wSF7:function(e,t){}});