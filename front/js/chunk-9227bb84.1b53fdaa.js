(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9227bb84"],{"0d46":function(e,t,a){},"374a":function(e,t,a){},"9b5e":function(e,t,a){"use strict";a.r(t),a.d(t,"allList",(function(){return i})),a.d(t,"query",(function(){return r})),a.d(t,"listByCardId",(function(){return s}));var n=a("b775");function i(e){return Object(n["a"])({url:"/index/miaosha/all",method:"get",params:e})}function r(e){return Object(n["a"])({url:"/index/miaosha/query",method:"get",params:e})}function s(e){return Object(n["a"])({url:"/index/miaosha/list_by_card_id",method:"get",params:e})}},c826:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"wrap miaosha_detail"},[a("div",{staticClass:"banner"},[a("img",{staticClass:"cover",attrs:{src:e.detail.cover,alt:""}}),a("div",{staticClass:"time"},[a("span",[e._v("活动截止时间："+e._s(e.detail.over_time))])]),a("h3",[e._v(e._s(e.detail.name))]),a("div",{staticClass:"bot"},[a("div",{staticClass:"price"},[a("span",{staticClass:"now_price"},[e._v("￥"+e._s(e.detail.now_price&&e.detail.now_price.toFixed(2)))]),a("span",{staticClass:"old_price"},[e._v("原价:￥"+e._s(e.detail.old_price&&e.detail.old_price.toFixed(2)))])]),a("div",{staticClass:"sell"},[e._v("已秒 "+e._s(e.detail.people)+" 个")])])]),a("div",{staticClass:"detail"},[a("div",{staticClass:"box"},[a("h3",[e._v("会员卡详情")]),a("div",{staticClass:"item"},[a("span",[e._v("卡名称")]),a("span",[e._v(e._s(e.detail.card_name))])]),a("div",{staticClass:"item"},[a("span",[e._v("余额")]),1==e.detail.type?a("span",[e._v(e._s(e.detail.times)+"次")]):6==e.detail.type?a("span",[e._v(e._s(e.detail.price)+"元")]):7==e.detail.type?a("span",[e._v(e._s(e.detail.hours)+"小时")]):a("span",[e._v("不限制时间")])]),a("div",{staticClass:"item"},[a("span",[e._v("有效期")]),1==e.detail.expire_date_on?a("span",[e._v(e._s(e.detail.expire_date)+"天")]):a("span",[e._v("不限")])])]),a("div",{staticClass:"box"},[a("h3",[e._v("支持课程")]),e._l(e.binds,(function(t){return a("div",{key:t.id,staticClass:"item"},[a("span",[e._v(e._s(t.course_name))])])}))],2),a("div",{staticClass:"box"},[a("h3",[e._v("适用场馆")]),a("div",{staticClass:"item"},[a("div",[e._v(e._s(e.venues.name))]),a("div",{staticClass:"contact"},[e._v("联系场馆")])])]),a("div",{staticClass:"box"},[a("h3",[e._v("秒杀说明")]),a("div",{staticClass:"content"},[e._v(" "+e._s(e.detail.des)+" ")])])]),a("div",{staticClass:"detail_info",domProps:{innerHTML:e._s(e.detail.content)}}),a("div",{staticClass:"btn"},[a("van-button",{staticClass:"left_btn",attrs:{plain:"",hairline:"",block:""}},[e._v("我的订单")]),a("van-button",{staticClass:"right_btn",attrs:{disabled:0==e.detail.tempStatus,block:"",type:"primary","native-type":"submit"},on:{click:e.sSubmit}},[1==e.detail.tempStatus?a("span",[e._v("立即抢购")]):a("span",[e._v("活动已经结束")])])],1)])},i=[],r=a("6abc"),s=a("60b5"),c=(a("6a61"),a("9065"),a("2cde"),a("a336"),a("8545"),a("ed08")),d=a("9b5e"),o=a("f4d0"),u=a("7e70"),l=a("444f"),p={data:function(){return{detail:{id:"",name:"",card_name:"",cover:"",card_cover:"",limit:"",now_price:"",old_price:"",over_time:"",people:"",price:"",status:""},binds:[],venues:{},userId:c["a"].get("user_id")}},mounted:function(){this.fetchData(),this.fetchVenues(),this.executeWeixin()},methods:{executeWeixin:function(){return Object(s["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.jssdk_config({url:location.href.split("#")[0]});case 2:t=e.sent,200==t.code&&(a=t.data,l.error((function(e){console.log(e)})),l.config(Object(r["a"])(Object(r["a"])({},a),{},{debug:!1})));case 4:case"end":return e.stop()}}),e)})))()},fetchData:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e.$route.params.id,t.next=3,d.query({id:a});case 3:n=t.sent,200==n.code&&(e.detail=n.data,e.detail.content=n.data.content.replace(/<img/g,"<img style='max-width:100%; height:auto;'"),i=(new Date).getTime(),1==n.data.status&&(r=Object(c["e"])(n.data.over_time).timeStamp,e.detail.tempStatus=i>r?0:1),e.getListByCardId(n.data.bind_card_id));case 5:case"end":return t.stop()}}),t)})))()},getListByCardId:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,d.listByCardId({card_id:e});case 2:n=a.sent,200==n.code&&(t.binds=n.data);case 4:case"end":return a.stop()}}),a)})))()},fetchVenues:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o.query();case 2:a=t.sent,200==a.code&&(e.venues=a.data);case 4:case"end":return t.stop()}}),t)})))()},sSubmit:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var a,n,i,d,o,p,_,m,v,f,b,h,g,x,w,y,C;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!=e.detail.tempStatus){t.next=3;break}return e.$$toast("活动结束了"),t.abrupt("return");case 3:if(a=e,n=c["a"].get("user_openid"),i=e.detail.name,d=e.detail.id,o=e.detail.bind_card_id,p=e.detail.now_price,_=e.userId,m=2,v=2,f="【线下课程】秒杀-会员卡购买",b=0,h=0,g=0,x=e.detail.type,w="【线下课程】微信支付购卡",y=e.detail.price,1==e.detail.type?b=e.detail.times:7==e.detail.type&&(g=e.detail.hours),1==e.detail.expire_date_on&&(h=e.detail.expire_date),n){t.next=24;break}return e.$toast("获取用户信息失败"),t.abrupt("return");case 24:return t.next=26,u.pay({openid:n,total_fee:Math.ceil(100*e.detail.now_price)});case 26:C=t.sent,200==C.code?l.ready(Object(s["a"])(regeneratorRuntime.mark((function e(){var t,c,k;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=C.data,c=t.options,k=t.extra,c.success=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u.payOk(Object(r["a"])(Object(r["a"])({},k),{},{name:i,sell_type_name:f,sell_type:v,openid:n,member_id:_,active_id:d,card_type_id:o,pay_type:m,amount:p,normal_amount:y,times:b,expire_date:h,hours:g,card_model:x,remark:w}));case 2:t=e.sent,200==t.code&&(a.$notify({message:t.msg,color:"#ffffff",background:"#00B76F"}),setTimeout((function(){a.$router.push({path:"/pay/success"})}),500));case 4:case"end":return e.stop()}}),e)}))),c.cancel=function(){console.log("已经取消")},c.fail=function(){console.log("支付失败")},l.chooseWXPay(c);case 7:case"end":return e.stop()}}),e)})))):console.log(C);case 28:case"end":return t.stop()}}),t)})))()}}},_=p,m=(a("d765"),a("d31a"),a("5d22")),v=Object(m["a"])(_,n,i,!1,null,"0b57a082",null);t["default"]=v.exports},d31a:function(e,t,a){"use strict";a("0d46")},d765:function(e,t,a){"use strict";a("374a")},f4d0:function(e,t,a){"use strict";a.r(t),a.d(t,"query",(function(){return i}));var n=a("b775");function i(e){return Object(n["a"])({url:"/index/venues/query",method:"get",params:e})}}}]);
//# sourceMappingURL=chunk-9227bb84.1b53fdaa.js.map